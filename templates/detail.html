<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{{ country.country }} - Wiki</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div style="max-width: 900px; margin: auto; padding: 20px;">
        <a href="/" class="back-btn">
            <span class="arrow">‚Üê</span> ‡∏Å‡∏•‡∏±‡∏ö‡∏™‡∏π‡πà‡∏´‡∏ô‡πâ‡∏≤‡∏´‡∏•‡∏±‡∏Å
        </a>
        
        <div style="background: var(--card-bg); padding: 40px; border-radius: 30px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); text-align: center;">
            {% if country.flag_url %}
                <img src="{{ country.flag_url }}" alt="flag" 
                     style="max-width: 320px; border-radius: 20px; box-shadow: 0 8px 25px rgba(0,0,0,0.1); border: 5px solid #f9faff;">
            {% endif %}

            {% if country.capital %}
            <div style="margin-top: 10px; margin-bottom: 30px;">
                <span style="background: linear-gradient(135deg, #ffeaa7, #fab1a0); 
                 padding: 8px 25px; border-radius: 50px; font-weight: 600; 
                 color: #d63031; display: inline-flex; align-items: center; 
                 box-shadow: 0 4px 15px rgba(250, 177, 160, 0.4); border: 2px solid #fff;">
                üèõÔ∏è ‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡∏´‡∏•‡∏ß‡∏á: {{ country.capital }}
                </span>
            </div>
            {% endif %}

            <h1 style="margin-top: 30px; margin-bottom: 5px;">{{ country.country }}</h1>
            
            <div class="rating-container" style="margin-bottom: 30px;">
                <p style="color: var(--text-soft); font-size: 0.9rem; margin-bottom: 5px;">Rate this country:</p>
                <div class="stars" id="star-rating">
                    <span class="star" data-value="1">‚òÖ</span>
                    <span class="star" data-value="2">‚òÖ</span>
                    <span class="star" data-value="3">‚òÖ</span>
                    <span class="star" data-value="4">‚òÖ</span>
                    <span class="star" data-value="5">‚òÖ</span>
                </div>
                <p id="rating-status" style="font-size: 0.8rem; color: var(--secondary); margin-top: 5px; height: 1em;"></p>
            </div>

            <hr style="border: 0; border-top: 2px solid #f1f2f6; margin-bottom: 40px;">

            <h3 style="text-align: left; color: var(--primary); margin-bottom: 20px; display: flex; align-items: center;">
                <span style="margin-right: 10px;">üèôÔ∏è</span> ‡∏£‡∏≤‡∏¢‡∏ä‡∏∑‡πà‡∏≠‡πÄ‡∏°‡∏∑‡∏≠‡∏á‡πÉ‡∏ô‡∏õ‡∏£‡∏∞‡πÄ‡∏ó‡∏®
            </h3>

            <div style="display: flex; flex-wrap: wrap; gap: 12px; justify-content: flex-start;">
                <div style="display: flex; flex-wrap: wrap; gap: 12px; justify-content: flex-start;">
                    {% for city in country.cities %}
                        <span style="
                            {% if city == country.capital %}
                                background: linear-gradient(135deg, var(--secondary), var(--primary)); 
                                color: white; 
                                border: 2px solid #fff;
                                box-shadow: 0 4px 10px rgba(108, 92, 231, 0.2);
                            {% else %}
                                background: #f1f2f6; 
                                color: var(--text-main);
                            {% endif %}
                            padding: 10px 18px; border-radius: 12px; font-size: 0.9rem; transition: 0.3s; font-weight: 500;">
                            {{ city }} 
                            {% if city == country.capital %} ‚≠ê {% endif %}
                        </span>
                    {% endfor %}
                </div>
            </div>
        </div>
    </div>
    
    <script>
        const countryName = "{{ country.country }}";
        const stars = document.querySelectorAll('.star');
        const status = document.getElementById('rating-status');

        // ‡∏î‡∏∂‡∏á‡∏Ñ‡∏∞‡πÅ‡∏ô‡∏ô‡∏ó‡∏µ‡πà‡πÄ‡∏Ñ‡∏¢‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÑ‡∏ß‡πâ‡∏à‡∏≤‡∏Å LocalStorage
        const savedRating = localStorage.getItem(`rating_${countryName}`);
        if (savedRating) {
            updateStars(savedRating);
            status.innerText = "You rated this country!";
        }

        stars.forEach(star => {
            star.addEventListener('click', () => {
                const value = star.getAttribute('data-value');
                localStorage.setItem(`rating_${countryName}`, value);
                updateStars(value);
                status.innerText = "Rating saved!";
                setTimeout(() => { status.innerText = ""; }, 2000);
            });

            star.addEventListener('mouseover', () => {
                const value = star.getAttribute('data-value');
                highlightStars(value);
            });

            star.addEventListener('mouseout', () => {
                const currentRating = localStorage.getItem(`rating_${countryName}`) || 0;
                highlightStars(currentRating);
            });
        });

        function highlightStars(value) {
            stars.forEach(s => {
                s.style.color = s.getAttribute('data-value') <= value ? '#f1c40f' : '#ddd';
            });
        }

        function updateStars(value) {
            highlightStars(value);
        }
    </script>
</body>
</html>